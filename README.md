     Quick start checklist 
    
    
    
    1Ô∏è‚É£ Clone or create a new SwiftUI project
    git clone https://github.com/yourname/BarcodeScannerDemo.git](https://github.com/Agent00Matisse7/Barcode-Scanner-SwiftUI-Demo.git 
    
            or start a new Xcode project
    
    2Ô∏è‚É£ Add the three Swift files (BarcodeScanner.swift, CameraPreview.swift, ContentView.swift)
    
    3Ô∏è‚É£ Edit Info.plist ‚Üí add NSCameraUsageDescription
    
    4Ô∏è‚É£ Build & run on a real device (Developer Mode ON)
    
    5Ô∏è‚É£ Tap ‚ÄúStart Scan‚Äù, point the camera at a QR code / barcode ‚Üí see the result.
    

Barcode‚ÄëScanner SwiftUI Demo

    Version: 1.0‚ÄÉ|‚ÄÉSwift: 5.9‚ÄÉ|‚ÄÉiOS / iPadOS: 15‚ÄØ+

A minimal, self‚Äëcontained SwiftUI project that shows how to:

request camera permission,
configure an AVCaptureSession for many barcode/QR‚Äëcode formats,
present a live camera preview inside SwiftUI, and
return the scanned value to your UI.
The repository contains four core files:

File	Purpose
BarcodeScanner.swift	The ObservableObject that owns the AVCaptureSession, handles permission flow, and receives metadata callbacks.
CameraPreview.swift	A UIViewControllerRepresentable that bridges AVCaptureVideoPreviewLayer into SwiftUI.
ContentView.swift (you‚Äôll add this)	The SwiftUI view that drives the scanner, shows the preview, and displays the result or errors.
Info.plist	Must contain the privacy usage description for the camera.
Below you will find a ready‚Äëto‚Äëcopy ContentView, a step‚Äëby‚Äëstep guide to get the app running on a real device, and a reference of the supported barcode types.

üìñ Table of contents

Project setup
Add the camera usage description
ContentView implementation
Running on a physical device (developer mode required)
Understanding the permission flow & recovery
Supported barcode formats (metadata object types)
Troubleshooting checklist
Further enhancements & ideas

# 1Ô∏è‚É£ Project setup

Create a new SwiftUI app in Xcode (File ‚Üí New ‚Üí Project ‚Üí App).
Delete the autogenerated ContentView.swift ‚Äì we‚Äôll replace it with the one below.
Add the three source files you already have (BarcodeScanner.swift, CameraPreview.swift, and the new ContentView.swift).
Make sure the target‚Äôs Deployment Info is set to iOS‚ÄØ15 or later (required for AVCaptureMetadataOutputObjectsDelegate + SwiftUI compatibility).
# 2Ô∏è‚É£ Add the camera usage description

iOS requires a purpose string for any camera access.

Open Info.plist.
Add a new key Privacy - Camera Usage Description (or NSCameraUsageDescription).
Set the value to something helpful, e.g.:
"This app needs access to the camera to scan barcodes and QR codes."
Why?
If you forget this entry the app will crash at launch with a ‚ÄúThis app has crashed because it attempted to access privacy‚Äësensitive data without a usage description.‚Äù

# 3Ô∏è‚É£ ContentView implementation
What the view does Piece	Explanation


# 4Ô∏è‚É£ Running on a physical device (developer mode required)

Step	Action

1Ô∏è‚É£	Connect your iPhone / iPad to your Mac.

2Ô∏è‚É£	In Xcode ‚Üí Window ‚Üí Devices & Simulators, verify the device appears and shows ‚ÄúDeveloper Mode: On‚Äù. If you see ‚ÄúDeveloper Mode: Off‚Äù, tap the device, follow the onscreen prompts, and restart the iPhone/iPad.

3Ô∏è‚É£	Select your device as the destination (top‚Äëleft scheme dropdown).

4Ô∏è‚É£	Press ‚åò‚ÄØR (Run). The app will be installed and launched on the device.

5Ô∏è‚É£	The system will present the camera‚Äëpermission dialog. Tap Allow.

6Ô∏è‚É£	Tap Start Scan ‚Üí point the camera at a QR code or barcode. The detected string appears below the preview.

7Ô∏è‚É£	To test the denied path, go to Settings ‚Üí Privacy ‚Üí Camera ‚Üí YourApp and set it to Deny. Relaunch the app ‚Äì you‚Äôll see the custom alert with a link to Settings.

Tip: If you need to test the ‚Äúnot determined‚Äù path again, you can delete the app from the device, then reinstall it.


# 5Ô∏è‚É£ Understanding the permission flow & recovery

    let authorizationStatus = AVCaptureDevice.authorizationStatus(for: .video)
    
    switch authorizationStatus {
    case .authorized:      // ‚úÖ Already granted ‚Üí start the session immediately.
    
    case .notDetermined:  // ‚ùì First launch ‚Üí request access asynchronously.
    
    case .denied, .restricted: // üö´ User said ‚ÄúNo‚Äù or parental controls block ‚Üí show a friendly alert.
    
    @unknown default:     // Defensive: log unexpected cases.
    
    }
Why an alert?
iOS will not automatically re‚Äëprompt a user after they have denied permission. The only way to change it is:

Open Settings ‚Üí Privacy ‚Üí Camera ‚Üí YourApp ‚Üí toggle to On, or
Direct the user to Settings via UIApplication.openSettingsURLString (the alert button does that for you).
Recovering after a denial ‚Äì The alert in ContentView does exactly this. It surfaces the cameraAccessDeniedMessage defined in BarcodeScanner.

# 6Ô∏è‚É£ Supported barcode formats (metadata object types)

The scanner is configured with an extensive list to cover most global standards. Below is a concise cheat‚Äësheet:

AVMetadataObject.ObjectType	Human‚Äëreadable name	Typical use‚Äëcase

    .upce	UPC‚ÄëE	Small retail items
    
    .ean13	EAN‚Äë13	International products
    
    .ean8	EAN‚Äë8	Small packages
    
    .code128	Code 128	Shipping, inventory
    
    .code93	Code 93	Similar to Code 128
    
    .code39Mod43	Code 39 (Mod 43)	Industrial labeling
    
    .qr	QR Code	URLs, contact info, custom data
    
    .aztec	Aztec	Transport tickets
    
    .dataMatrix	Data Matrix	Small item marking
    
    .pdf417	PDF‚Äë417	Driver‚Äôs licenses, boarding passes
    
    .microPDF417	Micro PDF‚Äë417	Small high‚Äëdensity data
    
    .microQR	Micro QR	Very small QR codes
    
    .gs1DataBar	GS1 DataBar (RSS)	Retail pricing
    
    .gs1DataBarLimited	GS1 DataBar Limited	Variant for small items
    
    .gs1DataBarExpanded	GS1 DataBar Expanded	More data capacity
    
    .interleaved2of5	Interleaved 2 of 5	Logistics, ITF‚Äë14
    
    .itf14	ITF‚Äë14	Shipping cartons
    
    .gs1DataBarExpanded	GS1 DataBar Expanded	Larger data sets

Customizing ‚Äì If you only need a subset (e.g., just QR & Code‚Äë128), replace the metadataOutput.metadataObjectTypes = [...] line with the types you care about. Fewer types can improve scanning performance on older hardware.

# 7Ô∏è‚É£ Troubleshooting checklist

Symptom	Likely cause	Fix
App crashes on launch	Missing NSCameraUsageDescription in Info.plist	Add the key with a descriptive string.
No preview appears	captureSession never started (e.g., permission denied)	Check the permission alert, ensure you tapped Allow; monitor showAccessDeniedAlert in the UI.
detectedBarcode never updates	Scanning paused before a code was read, or the barcode type isn‚Äôt in the allowed list.	Verify the barcode you test matches one of the object types.
Camera view is black, but session is running	Preview layer not sized correctly after orientation change.	The updateUIViewController method already resizes; ensure you run on a real device (simulator has no camera).
‚ÄúOpen Settings‚Äù button does nothing	Running in simulator (iOS‚ÄØSimulator cannot open Settings URL).	Test on a physical device.
Performance lag	Too many metadata types, or device is older.	Reduce metadataObjectTypes to only what you need.
Permission denied even after tapping ‚ÄúAllow‚Äù	Device restrictions (Screen Time, corporate MDM) or you previously denied and the alert is not re‚Äëpresented.	Go to Settings ‚Üí Privacy ‚Üí Camera manually and enable it.
# 8Ô∏è‚É£ Further enhancements & ideas

# Idea

# How to implement

    1.Flash/torch toggle-----Use AVCaptureDevice.default(for: .video)?.torchMode = .on/.off. Add a button that toggles the mode, checking hasTorch.
    
    2.Continuous scanning-----Instead of stopScanning() after the first detection, keep the session alive and store results in an array.
    
    3.Sound feedback-----Play a short system sound (AudioServicesPlaySystemSound) when a barcode is successfully read.
    
    4.Barcode format UI hint-----Show icons for the supported formats (QR, Code‚Äë128, etc.) so users know what to aim for.
    
    5.Result validation-----If you expect a URL, validate with URL(string:) before presenting; otherwise show an error.
    
    6.Share / copy result-----Add a ShareLink or Button that copies the scanned string to the clipboard (UIPasteboard.general.string).
    
    7.Combine with CoreLocation	Associate a GPS coordinate with the scan (use CLLocationManager), useful for inventory tracking.
    
    8.Custom overlay (frame)------Overlay a semi‚Äëtransparent rectangle to guide the user where to position the barcode.
    
    9.Unit tests----Mock AVCaptureMetadataOutputObjectsDelegate to verify that detectedBarcode updates correctly.
    
    10Multiplatform (macOS) support------Replace AVCaptureDevice.default(for: .video) with the macOS equivalent and adapt the preview view for NSViewRepresentable.

@StateObject private var scanner = BarcodeScanner()	Instantiates the scanner once for the lifetime of the view.
if let session = scanner.captureSession, isScanning	Shows the live preview only when a session exists and the user has pressed ‚ÄúStart Scan‚Äù.
scanner.showAccessDeniedAlert	Triggers a native alert that explains why the camera is required and offers a shortcut to Settings.
startOrResumeScanning()	Toggles between starting and pausing the capture session.
resetScanner()	Clears the previous code, restarts the camera and resets UI state.
onAppear / onDisappear	Guarantees the session is created when the view appears and stopped when it disappears (good for memory and battery).
